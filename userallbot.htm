<!DOCTYPE html>
<html lang="ru">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Test @PiperPiedBot WebApps API</title>
   <script src="https://telegram.org/js/telegram-web-app.js"></script>
   <style>
      body {
         color: var(--tg-theme-text-color);
         background: var(--tg-theme-bg-color);
         display: flex;
         flex-direction: column;
         align-items: center;
         font-size: 18px;
      }
      .hint { color: var(--tg-theme-hint-color); }
      .link { color: var(--tg-theme-link-color); }
   </style>
</head>

<body>
   <div id="usercard"></div>
   <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</p>
   <a class="link" href="https://t.me/c/1699696734/166">üí≤–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –ö–∞–Ω–∞–ª</a>
   <a class="link" href="https://t.me/c/1733213073/5367">üí≤–ü—Ä–∏–≤–∞—Ç–Ω–∞—è –ì—Ä—É–ø–ø–∞</a>
   <a class="link" href="https://t.me/piper_pied/284">üÜì–ü—É–±–ª–∏—á–Ω—ã–π –ö–∞–Ω–∞–ª</a>
   <a class="link" href="https://t.me/piper_pied_discuss/22089">üÜì–ü—É–±–ª–∏—á–Ω–∞—è –ì—Ä—É–ø–ø–∞</a>
   <a class="link" href="https://pegakmop.t.me">‚ö†Ô∏è–ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è —Å–≤—è–∑–∏</a>
   <p class="hint">–ï—Å–ª–∏ –≤—ã –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –Ω–∞—à –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–∞–Ω–∞–ª, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤–∞–º –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.</p>
</body>

<script>
   let tg = window.Telegram.WebApp;
   tg.expand();
   let userId = tg.initDataUnsafe.user?.id;

   fetch('https://api.telegram.org/bot5021692760:AAFP4REQhEq5n_8SD0g0JVxQCb6pIh6b0g4/GetChatMember', {
      method: 'POST',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      body: new URLSearchParams({ chat_id: '-1001699696734', user_id: userId }).toString()
   })
   .then(res => res.json())
   .then(data => {
      let status = data?.result?.status;
      let redirectUrl = "http://q900950b.beget.tech/bot.php";

      switch (status) {
         case 'creator':
         case 'administrator':
         case 'member':
            setTimeout(() => window.location.replace(redirectUrl), 3000);
            break;
         case 'left':
            alert('‚ö†Ô∏è –í—ã –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –Ω–∞—à –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–∞–Ω–∞–ª.');
            window.location.href = 'https://t.me/+x-5Kce_5vIU2ZjJi';
            break;
         default:
            alert('‚õîÔ∏è –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω.');
            window.location.href = 'https://t.me/+x-5Kce_5vIU2ZjJi';
      }
   })
   .catch(error => alert("–û—à–∏–±–∫–∞: " + error.message));

   let usercard = document.getElementById("usercard");
   let userInfo = tg.initDataUnsafe.user;
   usercard.innerHTML = `<p>${userInfo?.first_name} ${userInfo?.last_name} @${userInfo?.username} (${userInfo?.language_code})</p>
                         <p>ID: ${userInfo?.id}</p>`;
</script>

</html>
